2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Configure stats pid to 43223
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Loading settings from /AIRvePFS/ai4science/users/yupei/ProfileBFN-pro/wandb/settings
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'api_key': '***REDACTED***'}
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'represent_learning/training.py', 'program_abspath': '/AIRvePFS/ai4science/users/yupei/ProfileBFN-pro/represent_learning/training.py', 'program': '/AIRvePFS/ai4science/users/yupei/ProfileBFN-pro/represent_learning/training.py'}
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-12-02 11:37:09,429 INFO    MainThread:43223 [wandb_init.py:_log_setup():521] Logging user logs to ./wandb/run-20241202_113709-98di4h20/logs/debug.log
2024-12-02 11:37:09,430 INFO    MainThread:43223 [wandb_init.py:_log_setup():522] Logging internal logs to ./wandb/run-20241202_113709-98di4h20/logs/debug-internal.log
2024-12-02 11:37:09,430 INFO    MainThread:43223 [wandb_init.py:init():561] calling init triggers
2024-12-02 11:37:09,430 INFO    MainThread:43223 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'setting': {'seed': 20000812, 'ROOTDIR': './', 'os_environ': {'WANDB_API_KEY': '4cf78fcc7f33e9c70730eeb2f983cbc04b4bb9cd', 'WANDB_RUN_ID': None, 'CUDA_VISIBLE_DEVICES': '0,1,2,3,4,5,6,7', 'MASTER_ADDR': 'localhost', 'MASTER_PORT': 12315}, 'wandb_config': {'project': 'Thermostability', 'name': 'ProfileBFN_650M'}, 'tensorboard_config': {'save_dir': './tensorboard/', 'name': 'Thermostability', 'version': 'Thermostability', 'log_graph': False, 'default_hp_metric': True, 'prefix': ''}}, 'model_checkpoint': {'monitor': 'valid/valid_loss', 'mode': 'min', 'save_top_k': 1, 'save_last': True, 'verbose': True, 'dirpath': 'checkpoints/Thermostability_trainThermostability_BFN', 'filename': 'valid_loss_{valid/valid_loss:.5f}', 'auto_insert_metric_name': False, 'save_weights_only': True}, 'model': {'model_py_path': 'bfn/bfn_regression_model', 'kwargs': {'net_name': '/sharefs/gongjj/accounting/gongjj_dev_bfn4prot/bfn_650M_b2m_fromESM_16a100/27ea3bd_18159/', 'load_pretrained': True, 'load_prev_scheduler': True, 'save_top_k': 1, 'freeze_backbone': False, 'dropout': 0.0, 'use_lora': False}, 'lr_scheduler_kwargs': {'last_epoch': -1, 'init_lr': 2e-05, 'on_use': False}, 'optimizer_kwargs': {'betas': [0.9, 0.98], 'weight_decay': 0.01}, 'save_path': 'checkpoints/Thermostability_trainThermostability_BFN'}, 'dataset': {'dataset_py_path': 'bfn/bfn_regression_dataset', 'dataloader_kwargs': {'batch_size': 1, 'num_workers': 8}, 'train_lmdb': './data/LMDB/Thermostability/normal/train', 'valid_lmdb': './data/LMDB/Thermostability/normal/test', 'test_lmdb': './', 'kwargs': {'tokenizer': '/sharefs/gongjj/accounting/gongjj_dev_bfn4prot/bfn_650M_b2m_fromESM_16a100/27ea3bd_18159/', 'mix_max_norm': [40, 67]}}, 'Trainer': {'max_epochs': 200, 'log_every_n_steps': 1, 'strategy': {'find_unused_parameters': True}, 'logger': 'wandb', 'val_check_interval': 1.0, 'accelerator': 'gpu', 'devices': 'auto', 'num_nodes': 1, 'accumulate_grad_batches': 8, 'precision': 16, 'num_sanity_val_steps': 0, 'enable_progress_bar': True}}
2024-12-02 11:37:09,430 INFO    MainThread:43223 [wandb_init.py:init():611] starting backend
2024-12-02 11:37:09,430 INFO    MainThread:43223 [wandb_init.py:init():615] setting up manager
2024-12-02 11:37:09,431 INFO    MainThread:43223 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: fork
2024-12-02 11:37:09,432 INFO    MainThread:43223 [wandb_init.py:init():623] backend started and connected
2024-12-02 11:37:09,437 INFO    MainThread:43223 [wandb_init.py:init():715] updated telemetry
2024-12-02 11:37:09,680 INFO    MainThread:43223 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-12-02 11:37:52,017 INFO    MainThread:43223 [wandb_run.py:_on_init():2357] communicating current version
2024-12-02 11:37:52,377 INFO    MainThread:43223 [wandb_run.py:_on_init():2366] got version response upgrade_message: "wandb version 0.18.7 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-12-02 11:37:52,378 INFO    MainThread:43223 [wandb_init.py:init():799] starting run threads in backend
2024-12-02 11:37:55,570 INFO    MainThread:43223 [wandb_run.py:_console_start():2335] atexit reg
2024-12-02 11:37:55,571 INFO    MainThread:43223 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-12-02 11:37:55,572 INFO    MainThread:43223 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-12-02 11:37:55,572 INFO    MainThread:43223 [wandb_run.py:_redirect():2280] Redirects installed.
2024-12-02 11:37:55,573 INFO    MainThread:43223 [wandb_init.py:init():842] run started, returning control to user process
