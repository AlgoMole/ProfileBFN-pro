2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Configure stats pid to 41978
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Loading settings from /AIRvePFS/ai4science/users/yupei/ProfileBFN-pro/wandb/settings
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'api_key': '***REDACTED***'}
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'represent_learning/training.py', 'program_abspath': '/AIRvePFS/ai4science/users/yupei/ProfileBFN-pro/represent_learning/training.py', 'program': '/AIRvePFS/ai4science/users/yupei/ProfileBFN-pro/represent_learning/training.py'}
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_init.py:_log_setup():521] Logging user logs to ./wandb/run-20241202_113406-m1n22l4i/logs/debug.log
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_init.py:_log_setup():522] Logging internal logs to ./wandb/run-20241202_113406-m1n22l4i/logs/debug-internal.log
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_init.py:init():561] calling init triggers
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'setting': {'seed': 20000812, 'ROOTDIR': './', 'os_environ': {'WANDB_API_KEY': '4cf78fcc7f33e9c70730eeb2f983cbc04b4bb9cd', 'WANDB_RUN_ID': None, 'CUDA_VISIBLE_DEVICES': '0,1,2,3,4,5,6,7', 'MASTER_ADDR': 'localhost', 'MASTER_PORT': 12315}, 'wandb_config': {'project': 'GO_CC', 'name': 'BFN_650M'}, 'tensorboard_config': {'save_dir': './tensorboard/', 'name': 'GO_CC', 'version': 'GO_CC', 'log_graph': False, 'default_hp_metric': True, 'prefix': ''}}, 'model_checkpoint': {'monitor': 'valid/valid_f1_max', 'mode': 'max', 'save_top_k': 1, 'save_last': True, 'verbose': True, 'dirpath': 'checkpoints/GO/CC_trainGO/CC_BFN', 'filename': 'valid_f1_max_{valid/valid_f1_max:.5f}', 'auto_insert_metric_name': False, 'every_n_train_steps': 0, 'every_n_epochs': 1}, 'model': {'model_py_path': 'bfn/bfn_annotation_model', 'kwargs': {'net_name': '/sharefs/gongjj/accounting/gongjj_dev_bfn4prot/bfn_650M_b2m_fromESM_16a100/27ea3bd_18159/', 'load_pretrained': True, 'anno_type': 'GO_CC', 'load_prev_scheduler': True, 'save_top_k': 1, 'freeze_backbone': False, 'dropout': 0.0, 'use_lora': False}, 'lr_scheduler_kwargs': {'last_epoch': -1, 'init_lr': 1.5e-05, 'on_use': False}, 'optimizer_kwargs': {'betas': [0.9, 0.98], 'weight_decay': 0.01}, 'save_path': 'checkpoints/GO/CC_trainGO/CC_BFN'}, 'dataset': {'dataset_py_path': 'bfn/bfn_annotation_dataset', 'dataloader_kwargs': {'batch_size': 1, 'num_workers': 8}, 'train_lmdb': './data/LMDB/GO/AF2/CC/normal/train', 'valid_lmdb': './data/LMDB/GO/AF2/CC/normal/test', 'test_lmdb': './', 'kwargs': {'tokenizer': '/sharefs/gongjj/accounting/gongjj_dev_bfn4prot/bfn_650M_b2m_fromESM_16a100/27ea3bd_18159/'}}, 'Trainer': {'max_epochs': 100, 'log_every_n_steps': 1, 'strategy': {'find_unused_parameters': True}, 'logger': 'wandb', 'val_check_interval': 1.0, 'accelerator': 'gpu', 'devices': 'auto', 'num_nodes': 1, 'accumulate_grad_batches': 8, 'precision': 16, 'num_sanity_val_steps': 0}}
2024-12-02 11:34:06,829 INFO    MainThread:41978 [wandb_init.py:init():611] starting backend
2024-12-02 11:34:06,830 INFO    MainThread:41978 [wandb_init.py:init():615] setting up manager
2024-12-02 11:34:06,830 INFO    MainThread:41978 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: fork
2024-12-02 11:34:06,832 INFO    MainThread:41978 [wandb_init.py:init():623] backend started and connected
2024-12-02 11:34:06,837 INFO    MainThread:41978 [wandb_init.py:init():715] updated telemetry
2024-12-02 11:34:07,084 INFO    MainThread:41978 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-12-02 11:34:13,342 INFO    MainThread:41978 [wandb_run.py:_on_init():2357] communicating current version
2024-12-02 11:34:13,703 INFO    MainThread:41978 [wandb_run.py:_on_init():2366] got version response upgrade_message: "wandb version 0.18.7 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-12-02 11:34:13,703 INFO    MainThread:41978 [wandb_init.py:init():799] starting run threads in backend
2024-12-02 11:34:16,943 INFO    MainThread:41978 [wandb_run.py:_console_start():2335] atexit reg
2024-12-02 11:34:16,943 INFO    MainThread:41978 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-12-02 11:34:16,943 INFO    MainThread:41978 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-12-02 11:34:16,944 INFO    MainThread:41978 [wandb_run.py:_redirect():2280] Redirects installed.
2024-12-02 11:34:16,944 INFO    MainThread:41978 [wandb_init.py:init():842] run started, returning control to user process
